import{_ as e,o as s,c as l,Q as a}from"./chunks/framework.01af844e.js";const g=JSON.parse('{"title":"Deploy AikoPanel","description":"","frontmatter":{},"headers":[],"relativePath":"aikopanel/deploy.md","filePath":"aikopanel/deploy.md"}'),n={name:"aikopanel/deploy.md"},t=a(`<h1 id="deploy-aikopanel" tabindex="-1">Deploy AikoPanel <a class="header-anchor" href="#deploy-aikopanel" aria-label="Permalink to &quot;Deploy AikoPanel&quot;">​</a></h1><h2 id="env" tabindex="-1">Env <a class="header-anchor" href="#env" aria-label="Permalink to &quot;Env&quot;">​</a></h2><p>The minimum configuration requirement is 1Core/512M RAM</p><table><thead><tr><th style="text-align:center;">Environment</th><th style="text-align:center;">Version</th></tr></thead><tbody><tr><td style="text-align:center;">System</td><td style="text-align:center;">Linux</td></tr><tr><td style="text-align:center;">PHP</td><td style="text-align:center;">7.4+</td></tr><tr><td style="text-align:center;">MySQL</td><td style="text-align:center;">5.7+</td></tr><tr><td style="text-align:center;">Redis</td><td style="text-align:center;">5.0+</td></tr><tr><td style="text-align:center;">Nginx</td><td style="text-align:center;">1.17+</td></tr></tbody></table><p>There are alternatives to the above environments, for example, nginx you can use caddy</p><p>The above environment version numbers are minimum requirements and may be higher than the actual requirements.</p><h2 id="install" tabindex="-1">Install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;Install&quot;">​</a></h2><ol><li>Configure aaPanel</li></ol><ul><li><p>You need to choose how your system is installed in <a href="https://www.aapanel.com/new/download.html#install" target="_blank" rel="noreferrer">aaPanel</a>. Ubuntu 20+ or Centos 7+ is installed here as the system environment.</p></li><li><p>Be sure to install aaPanel using Ubuntu 20+ or Centos 7+, other systems may have unknown issues.</p></li></ul><ol start="2"><li>Install Redis and fileinfo</li></ol><ul><li>aaPanel panel &gt; App Store &gt; PHP 7.4 and click Setting &gt; Install extentions &gt; redis, fileinfo to install.</li></ul><ol start="3"><li>Remove prohibited functions</li></ol><ul><li>aaPanel Panel &gt; App Store &gt; PHP 7.4 Click Setting &gt; Disabled functions will be removed from the list. <ul><li><code>putenv</code></li><li><code>proc_open</code></li><li><code>pcntl_alarm</code></li><li><code>pcntl_signal</code></li></ul></li></ul><ol start="4"><li>Add a site</li></ol><ul><li>aaPanel panel &gt; Website &gt; Add site. <ul><li>Fill in the domain name, select the PHP version, and select the database type as MySQL.</li><li>in Database, and PHP-74 in PHP Verison, and select MySQL in Database Type.</li></ul></li></ul><ol start="5"><li>Install AikoPanel</li></ol><ul><li><p>After logging in to the server via SSH, access the site path such as: /www/wwwroot/ Your site domain name.</p></li><li><p>The following commands need to be executed in the site directory.</p></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">chattr -i .user.ini</span></span>
<span class="line"><span style="color:#e1e4e8;">rm -rf .htaccess 404.html index.html .user.ini</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">chattr -i .user.ini</span></span>
<span class="line"><span style="color:#24292e;">rm -rf .htaccess 404.html index.html .user.ini</span></span></code></pre></div><ul><li>Execute the command to clone from Github to the current directory.</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">Dowload Source AikoPanel</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">Dowload Source AikoPanel</span></span></code></pre></div><ul><li>Execute commands to install dependent packages and AikoPanel</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">sh init.sh</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">sh init.sh</span></span></code></pre></div><ul><li>Follow the prompts to complete the installation</li></ul><ol start="6"><li>Configure the site directory and pseudo-static</li></ol><ul><li><p>After adding, edit the added site &gt; Site directory &gt; Running directory Select /public to save.</p></li><li><p>After adding, edit the URL of the added site &gt; rewrite and fill in the pseudo-static information.</p></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">location /downloads {</span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">location / {  </span></span>
<span class="line"><span style="color:#e1e4e8;">    try_files $uri $uri/ /index.php$is_args$query_string;  </span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">location ~ .*\\.(js|css)?$</span></span>
<span class="line"><span style="color:#e1e4e8;">{</span></span>
<span class="line"><span style="color:#e1e4e8;">    expires      1h;</span></span>
<span class="line"><span style="color:#e1e4e8;">    error_log off;</span></span>
<span class="line"><span style="color:#e1e4e8;">    access_log /dev/null; </span></span>
<span class="line"><span style="color:#e1e4e8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">location /downloads {</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">location / {  </span></span>
<span class="line"><span style="color:#24292e;">    try_files $uri $uri/ /index.php$is_args$query_string;  </span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">location ~ .*\\.(js|css)?$</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    expires      1h;</span></span>
<span class="line"><span style="color:#24292e;">    error_log off;</span></span>
<span class="line"><span style="color:#24292e;">    access_log /dev/null; </span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><ol start="7"><li>Configure a scheduled task</li></ol><ul><li>aaPanel Panel &gt; Cron. <ul><li>In Type of Task, select Shell Script, fill in AikoPanel</li><li>in Name of Task, select N Minutes in Period, select N Minutes 1 Minute , fill in PHP <code>/www/wwwroot/path/artisan schedule:run</code> in Script content</li></ul></li><li>Based on the above information, add a scheduled task that is executed every 1 minute.</li></ul><ol start="8"><li>Start the queue service</li></ol><ul><li><p>AikoPanel&#39;s system relies heavily on the queue service, and the queue service must be started to use AikoPanel normally. The following is a demonstration of the supervisor service in aaPanel to guard the queue service.</p></li><li><p>aaPanel Panel &gt; App Store &gt; Tools</p></li><li><p>Find the Supervisor to install, and after the installation is completed, click to fill in as follows <code>Setting &gt; Add Daemon</code></p><ul><li>In Name, fill in AikoPanel , select www in Run User, select Site Directory in Start Command, fill in php artisan horizon, fill in 1 in Processes</li></ul></li><li><p>After filling in, click Confirm to add and run.</p></li></ul><h1 id="frequently-asked-questions" tabindex="-1">frequently asked questions <a class="header-anchor" href="#frequently-asked-questions" aria-label="Permalink to &quot;frequently asked questions&quot;">​</a></h1><ul><li>Q: 500 error</li><li>A: Check the root directory permissions of the site, recursive 755, ensure that the directory has the permission of writable files, it may also be caused by the Redis extension not installed or Redis not followed. You can check the logs under storage/logs to troubleshoot errors, turn on debug mode, and disable anti-cross-site in site settings.</li></ul>`,32),i=[t];function o(r,p,c,d,u,h){return s(),l("div",null,i)}const m=e(n,[["render",o]]);export{g as __pageData,m as default};
